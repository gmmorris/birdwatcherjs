{"name":"Birdwatcherjs","tagline":"A covert error handling utility for Javascript. A small utility for implementing the NCZ Javascript error handling anti-pattern.","body":"Birdwatcher JS ![alt TravisCI Build](https://travis-ci.org/gmmorris/birdwatcherjs.svg?branch=master) [![Code Climate](https://codeclimate.com/github/gmmorris/birdwatcherjs/badges/gpa.svg)](https://codeclimate.com/github/gmmorris/birdwatcherjs) [![npm version](https://img.shields.io/npm/v/birdwatcher.svg?style=flat-square)](https://www.npmjs.com/package/birdwatcher)\r\n=======\r\n\r\nA small utility for implementing the NCZ JavaScript error handling pattern.\r\nTo understand the anti anti-pattern pattern: http://www.nczonline.net/blog/2009/04/28/javascript-error-handling-anti-pattern/\r\n\r\n## In the Browser (as ES5)\r\nTo use birdwatcher, all you have to do is tell birdwatcher to spy on an object and set the callback you wish to have called when an error is raised.\r\n\r\nAs Birdwatcher is implemented in ES6 using the ES6 module system, you first need to build a version of the utility which can work in the browser.\r\nI chose not to make any assumptions as to how Birdwatcher would be integrated into a project, so instead of providing a prebuilt version for the browsers, I simply recommend you use a module bundler that supports ES6.\r\nPersonally, I use [webpack](http://webpack.github.io/) along with [babel-loader](https://github.com/babel/babel-loader), but you can use whatever you find suitable.\r\n\r\nAssuming you bundled the Birdwatcher utility into it's own file named *birdwatcher.min.js* you may continue thusly:\r\n\r\n```html\r\n    <script type=\"text/javascript\" src=\"birdwatcher.min.js\"></script>\r\n```\r\n\r\n### Basic usage\r\n```js\r\n    window.theKing = {\r\n        giveUpThrone: function(){\r\n            throw new Error(\"The king will never be over thrown!\");\r\n        }\r\n    };\r\n\r\n    birdwatcher(window.theKing,{\r\n        onError:function(exception,name, id, method){\r\n            if(method == \"giveUpThrone\") {\r\n                assassin.killKing();\r\n            } else {\r\n                // some other error took place\r\n            }\r\n        }\r\n    });\r\n\r\n    // ...\r\n    if(runOutOfBread && runOutOfCake){\r\n      // will throw an error, which in turn will trigger the Assasin to kill the king\r\n      window.theKing.giveUpThrone();  \r\n    }\r\n```\r\n\r\n\r\n### Advanced usage\r\n\r\n#### Specifying different default configurations and different configurations for a specific object\r\n\r\nBy calling the birdwatcher.configure() function you can create a new entry point to Birdwatcher with a new custom configuration which will override the built in one.\r\nIf you want to specify a non default configuration variable for a specific object you can override default values of the configuration specifically for the current object when calling the main birdwatcher method by using the second argument.\r\n\r\n```js\r\n    window.theKing = {\r\n        giveUpThrone: function(){\r\n            throw new Error(\"The king will never be over thrown!\");\r\n        }\r\n    };\r\n\r\n    window.theAssassin = {\r\n        killTheKing: function(){\r\n            this.injectPoison(window.theKing);\r\n        },\r\n        killThePrince: function(){\r\n            throw new Error(\"No women and children!\");\r\n        }\r\n    };\r\n\r\n    var myGlobalBirdwatcher = birdwatcher.configure({\r\n      // no error caught in an object watched by this custom Birdwatcher will be errorized (wraped in an Error object)\r\n      errorize : false,\r\n      // And they will all call this function to handle the onError events... unless they are overriden especially\r\n      onError:function(srcObject, exception,name, method){\r\n          // all other error which were raised\r\n\r\n          if(name == \"King\" && method == \"giveUpThrone\") {\r\n              //will be called when the king is challenged to give up the throne\r\n          }\r\n      }\r\n    });\r\n\r\n    myGlobalBirdwatcher(window.theKing,\"King\");\r\n    myGlobalBirdwatcher(window.theAssassin,\"Assassin\",{\r\n      // override the default onError and use this one... the other default configrations will be inherited\r\n      onError:function(srcObject, exception,name, method){\r\n          // notify the rebels that the assassin has failed\r\n          // or rather when theAssassin.killThePrince() is called\r\n          // presumably that wasn't prince Joffrey, because that was no child, that was a monster!\r\n      }\r\n    });\r\n```\r\n\r\n#### Watching a single function\r\n\r\nIf you wish to plug a specific method of an object or a function variable into the birdwatcher mechanism you can call the main birdwatcher function and pass the specific method/variable as the first argument, same as with an object.\r\nNote though, that in order to call the function variable you will have to replace the reference you have to it manually.\r\n\r\n```js\r\n    var myErrorHandledFunction = function(){\r\n\t\t// ...\r\n\t};\r\n\r\n    var myObject = {\r\n\t\tmyErrorHandledMethod : function(){\r\n\t\t\t// ...\r\n\t\t}\r\n\t};\r\n\r\n    myErrorHandledFunction = birdwatcher(myErrorHandledFunction);\r\n    myObject.myErrorHandledMethod = birdwatcher(myObject.myErrorHandledMethod);\r\n```\r\n\r\n#### Preventing a rethrow\r\n\r\nThe default is to rethrow an error once it is caught, so that the normal error flow can be maintained even when an error\r\nis caught for special usages (such as logging).\r\nYou cen prevent the rethrow from happening by setting the rethrow config to false.\r\nThis can be used globally or at a single object's level.\r\n\r\n```js\r\n    let myBirdwatcher = birdwatcher.configure({\r\n        rethrow:false\r\n    });\r\n```\r\n\r\n\r\n## In ES6 (Node.js + Babel <3 )\r\nIf you're using ES6 you can simply import Birdwatcher and the Configure function from the module system.\r\n\r\n```\r\n  npm install --save-dev birdwatcher\r\n```\r\nAnd then where you want to use it simply:\r\n\r\n```js\r\n  import birdwatcher, {configure, isBirdwatcherError} from 'birdwatcher';\r\n```\r\n\r\nThis will provide you with the *birdwatcher* function, which is all you really need.\r\nIt will also provide you with the *configure* function you can use to create a new birdwatcher function with a custom configuration.\r\n\r\nFor example:\r\nIf you want a systemwide default onError handler, to send reports to your Frontend error aggregator, you can create one custom birdwatcher and use it throughout your system.\r\nI've used this approach in multiple different websites and projects and have foudn it a great way to seperate my error tracking from my business components.\r\n\r\n#### errorhandling.js\r\n```js  \r\n  import {configure} from 'birdwatcher';\r\n\r\n  export default configure({\r\n    onError : function(){\r\n      ... // error tracking logic\r\n    }\r\n  })\r\n```\r\n\r\n#### The source code of any component I wish to track\r\nIf you're using ES6:\r\n```js\r\n\r\n  // other component file\r\n  import errorhandling from 'errorhandling';\r\n\r\n  const SomeComponent = errorhandling({\r\n    ...\r\n  }, 'SomeComponentName');\r\n\r\n  // or\r\n\r\n  const myComponent = {\r\n    doThis : function(){},\r\n    doThat : function(){}\r\n  };\r\n\r\n  export default errorhandling(myComponent,'myComponentName');\r\n```\r\n\r\nYou can also attach birdwatching to the methods of a class definition by using the birdwatch method.\r\nI would suggest though, if you're already using ES6 and Babel, then why not go ahead and turn on Stage 0 so you can enjoy the benefits of using decorators (take a look under the ES7 heading).\r\n\r\n```js\r\n\r\n  // other component file\r\n\r\n  import birdwatch from 'birdwatcher';\r\n  import errorhandling from 'errorhandling';\r\n\r\n  class SomeComponent {\r\n    ...\r\n  }\r\n\r\n\r\n  export default birdwatch(errorhandling)(myComponent,'myComponentName');\r\n```\r\n\r\n\r\n## In ES7\r\nAnd if you're feeling experimental with ES7 decorators, you can also use birdwatcher by applying birdwatch decorator:\r\n\r\n```js\r\n  // other component file\r\n\r\n  import birdwatch from 'birdwatcher';\r\n  // your custom birdwatcher\r\n  import errorhandling from 'errorhandling';\r\n\r\n  @birdwatch(errorhandling,'SomeComponentName')\r\n  class SomeComponent {\r\n    ...\r\n  }\r\n\r\n  export default SomeComponent;\r\n```\r\n\r\nOr if you're not using a custom birdwatcher configuration (you *can* do this, but that doesn't mean you should. try and keep your error handling logic separate from your components, thats the whole point).\r\n\r\n```js\r\n  // other component file\r\n  import birdwatch from 'birdwatcher';\r\n\r\n  @birdwatch('SomeComponentName',{\r\n    onError: function(){\r\n      // ... some error handling\r\n    }\r\n  })\r\n  class SomeComponent {\r\n    ...\r\n  }\r\n\r\n  export default SomeComponent;\r\n```\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}